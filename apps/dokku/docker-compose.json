{
    "$schema": "../dynamic-compose-schema.json",
    "services": [
        {
            "name": "dokku",
            "image": "dokku/dokku:0.35.18",
            "internalPort": 8080,
            "isMain": true,
            "environment": {
                "DOKKU_HOSTNAME": "${DOKKU_HOSTNAME}",
                "DOKKU_HOST_ROOT": "/data/images",
                "DOKKU_LIB_HOST_ROOT": "/data/app"
            },
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data",
                    "containerPath": "/data"
                },
                {
                    "hostPath": "/var/run/docker.sock",
                    "containerPath": "/var/run/docker.sock"
                }
            ],
            "addPorts": [
                {
                    "hostPort": 3022,
                    "containerPort": 22,
                    "tcp": true
                }
            ],
            "extraLabels": {
                "traefik.http.routers.{{RUNTIPI_APP_ID}}-insecure.rule": "Host(`${APP_DOMAIN}`) || HostRegexp(`.+\\.${APP_DOMAIN}`)",
                "traefik.http.routers.{{RUNTIPI_APP_ID}}.rule": "Host(`${APP_DOMAIN}`) || HostRegexp(`.+\\.${APP_DOMAIN}`)",
                "traefik.http.routers.{{RUNTIPI_APP_ID}}-local-insecure.rule": "Host(`{{RUNTIPI_APP_ID}}.${LOCAL_DOMAIN}`) || HostRegexp(`.+\\.{{RUNTIPI_APP_ID}}\\.${LOCAL_DOMAIN}`)",
                "traefik.http.routers.{{RUNTIPI_APP_ID}}-local.rule": "Host(`{{RUNTIPI_APP_ID}}.${LOCAL_DOMAIN}`) || HostRegexp(`.+\\.{{RUNTIPI_APP_ID}}\\.${LOCAL_DOMAIN}`)",
                "traefik.http.routers.{{RUNTIPI_APP_ID}}.tls.domains[0].main": "${APP_DOMAIN}",
                "traefik.http.routers.{{RUNTIPI_APP_ID}}.tls.domains[0].sans": "*.${APP_DOMAIN}"
            }
        }
    ]
}